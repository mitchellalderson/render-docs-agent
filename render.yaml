# Render Blueprint for Docs Agent
# Deploy to Render.com with one click

projects:
  - name: docs-agent

    environments:
      - name: production

        services:
          # Backend API service
          - type: web
            name: docs-agent-backend
            runtime: docker
            region: oregon
            plan: starter
            dockerfilePath: ./backend/Dockerfile
            dockerContext: ./backend
            healthCheckPath: /health
            envVars:
              - key: NODE_ENV
                value: production
              - key: PORT
                value: 3001
              - key: CORS_ORIGIN
                fromService:
                  type: web
                  name: docs-agent-frontend
                  envVarKey: RENDER_EXTERNAL_URL
              - key: DB_HOST
                fromDatabase:
                  name: docs-agent-db
                  property: host
              - key: DB_PORT
                fromDatabase:
                  name: docs-agent-db
                  property: port
              - key: DB_NAME
                fromDatabase:
                  name: docs-agent-db
                  property: database
              - key: DB_USER
                fromDatabase:
                  name: docs-agent-db
                  property: user
              - key: DB_PASSWORD
                fromDatabase:
                  name: docs-agent-db
                  property: password
              - key: DATABASE_URL
                fromDatabase:
                  name: docs-agent-db
                  property: connectionString
              - key: DB_POOL_MAX
                value: 20
              - key: ANTHROPIC_API_KEY
                sync: false
              - key: OPENAI_API_KEY
                sync: false
              - key: CLAUDE_MODEL
                value: claude-sonnet-4-5-20250929
              - key: CLAUDE_MAX_TOKENS
                value: 4096
              - key: CLAUDE_TEMPERATURE
                value: 0.3
              - key: EMBEDDING_MODEL
                value: text-embedding-3-small
              - key: EMBEDDING_DIMENSIONS
                value: 1536
              - key: SIMILARITY_THRESHOLD
                value: 0.1
              - key: MAX_SOURCES
                value: 5
              - key: MAX_FILE_SIZE
                value: 10485760
              - key: RUN_SEED
                value: true

          # Frontend UI service
          - type: web
            name: docs-agent-frontend
            runtime: docker
            region: oregon
            plan: starter
            dockerfilePath: ./frontend/Dockerfile
            dockerContext: ./frontend
            envVars:
              - key: NEXT_PUBLIC_API_URL
                fromService:
                  type: web
                  name: docs-agent-backend
                  envVarKey: RENDER_EXTERNAL_URL
              - key: NEXT_PUBLIC_APP_NAME
                value: Docs Agent

        databases:
          - name: docs-agent-db
            databaseName: docs_agent
            user: docsagent
            plan: free
            region: oregon
            postgresMajorVersion: "16"
            ipAllowList: []
